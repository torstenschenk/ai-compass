1. Content & Wording
The objective is to move from raw data to "Decision Intelligence." The wording must be sharp, diagnostic, and prioritize the two most impactful findings.
Component Header:
Headline: Strategic Gap Analysis
Sub-headline: Identifying the "Delta" between your current position and the next level.
Card 1: The Talent Gap (People & Culture)
Context: Used when a high Delta exists between Leadership Strategy and Workforce Readiness.
Status Quo Text: "While your leadership has a clear vision, there is a disconnect with the operational workforce. 65% of your responses indicate a 'Cautious' mindset toward AI."
Strategic Risk: "Without addressing psychological safety and upskilling, your technical tools will lack the adoption needed for ROI."
Badge: HIGH
Card 2: The Compliance Vulnerability (Governance & Ethics)
Context: Used when high-weight checklist items (like AI Policy or Code of Conduct) are missing.
Status Quo Text: "Your technical velocity is outpacing your oversight. The lack of a defined 'AI Code of Conduct' creates significant long-term legal and reputational risks."
Strategic Risk: "Specifically regarding upcoming EU AI Act requirements, the absence of governance poses a critical liability to scaling operations."
Badge: CRITICAL

2. Design & UI SpecificationsThe design focuses on "Risk Awareness."
It should feel different from the Maturity Profile by using warmer, alert-driven colors.
Layout:Container: Two stacked horizontal cards (Flexbox/Grid).
Spacing: $24\text{px}$ gap between cards; 
$32\text{px}$ padding inside cards.
Visual Elements using Icons

3. Technical Requirements (MVP Implementation)
The "Logic Engine" must execute the two-stage logic defined in the objective.
Stage 1: Statistical Analysis ($Z$-Scores)
Formula: $Z = (x - \mu) / \sigma$ (where $x$ is the user's score, $\mu$ is peer mean, $\sigma$ is peer std dev).
Detection: Flag any dimension where $Z < -1.2$.
Prioritization: If multiple dimensions are flagged, select the one with the largest Delta to the "Strategy" dimension.
Stage 2: Weighted Checklist Logic
Data Source: checklist_items table with columns [item_id, status (boolean), question_weight (integer)].
Execution: Filter for status = False. Sort by question_weight descending.
Output: Select the top item as the second gap (typically Compliance or Data Governance).
LLM Prompt for Dynamic Synthesis:Input Variables: {{dimension_scores}}, {{top_missing_checklist_items}}, {{industry_benchmarks}}.Constraint: "Generate exactly 2 gaps. 
Use the 'Status Quo vs. Strategic Risk' format. Limit each description to 30 words to prevent UI overflow."


# Strategic Gap Analysis (MVP) — Spec

## 1) Purpose
Turn scores + benchmark deltas into **exactly 2** sharp, diagnostic findings:
- **Gap A (statistical)**: biggest underperformance vs peers (Z-score based)
- **Gap B (checklist/controls)**: highest-weight missing foundational control (rule-based)

## 2) Content & Wording (UI Copy Rules)

### Component Header
- **Headline:** Strategic Gap Analysis
- **Sub-headline:** Identifying the delta between your current position and the next level.

### Output Format (exact structure per gap)
Each gap renders as one card with:
- **Title** (e.g., “The Talent Gap (People & Culture)”)
- **Status Quo** (max 30 words)
- **Strategic Risk** (max 30 words)
- **Badge**: `MEDIUM | HIGH | CRITICAL`

### Copy Constraints (hard)
- Always render **exactly 2 cards**
- No fluff, no generic consulting phrases
- Keep each text line short to prevent overflow

> Note: The sample texts below are templates. Values like “65%” must be computed from answers, otherwise omit the percentage.

## 3) Design & UI Specifications (Risk Awareness Style)
- Layout: **2 stacked horizontal cards**
- Spacing: `gap: 24px`, padding inside cards: `32px`
- Cards: white background, rounded corners (12–16px), subtle shadow
- Risk styling:
  - `MEDIUM`: neutral/amber accent
  - `HIGH`: orange accent
  - `CRITICAL`: red accent
- Each card includes:
  - left icon (alert/risk)
  - badge pill on the right

## 4) Technical Requirements (MVP Implementation)

## 4.1 Inputs (from existing backend)
From `GET /api/v1/assessments/{assessment_id}?token=...` or internal service call:
- `dimension_scores`: `{ dimension_key: score_0_100 }` (or 0–5, but be consistent)
- `overall_cluster_profile` (optional for messaging)
- `peer_benchmark` per dimension:
  - `peer_mean[dimension_key]`
  - `peer_std[dimension_key]`
  - `peer_n`

Also available in DB:
- answered questions + selections (for simple “% cautious” type facts)

## 4.2 Gap A — Statistical Detection (Z-Score)
### Formula
`Z = (x - μ) / σ`

### Detection
- Compute Z per dimension
- Flag dimension if `Z < -1.2`
- If none flagged:
  - choose the **lowest absolute dimension score** as Gap A

### Prioritization
- Select the **worst Z** (most negative)
- Optional tie-breaker:
  - prefer dimensions with higher total weight in questionnaire

### Gap A Badge rule (MVP)
- `CRITICAL` if `Z <= -2.0`
- `HIGH` if `-2.0 < Z <= -1.5`
- `MEDIUM` otherwise

## 4.3 Gap B — “Checklist / Controls” Logic (no extra tables required)

### Important (DB reality check)
Your current schema does **not** include a `checklist_items` table.
So MVP must derive “missing controls” from questionnaire metadata.

### Minimal approach (recommended)
Use one of these sources (pick ONE and keep it stable):
1) **DB tags on options/questions** (preferred)
   - `questionnaire_options.tags` contains:
     - `{"control": true, "domain": "governance", "missing": true, "weight": 5}`
   - OR add similar tags on questions (if you extend schema later)

2) **Static config mapping in backend** (fastest MVP)
   - A small dict in code:
     - `CONTROL_KEYS = [{question_key, missing_option_keys, weight, domain, title_template}]`

### Rule
- Identify controls where the user selected a “missing/absent” option
  - (either by tag `missing:true` or by `missing_option_keys`)
- Sort by `weight` desc
- Select **top 1** as Gap B

### Gap B Badge rule (MVP)
- `CRITICAL` if weight >= 5
- `HIGH` if weight 3–4
- `MEDIUM` if weight <= 2

## 4.4 Output Contract (backend → frontend)
Return a stable payload, generated deterministically (LLM optional later):

```json
{
  "gaps": [
    {
      "id": "gap_a",
      "title": "The Talent Gap (People & Culture)",
      "badge": "HIGH",
      "status_quo": "While leadership intent is solid, workforce readiness lags behind peers, indicating adoption friction and limited AI confidence.",
      "strategic_risk": "Without upskilling and psychological safety, tools won’t be adopted at scale—reducing ROI and slowing delivery."
    },
    {
      "id": "gap_b",
      "title": "The Compliance Vulnerability (Governance & Ethics)",
      "badge": "CRITICAL",
      "status_quo": "Your delivery speed is outpacing oversight. Missing AI policy and accountability controls increases legal and reputational exposure.",
      "strategic_risk": "Scaling without governance creates compounding risk—especially under EU AI Act-aligned requirements and customer due diligence."
    }
  ],
  "meta": {
    "z_threshold": -1.2,
    "peer_n": 500
  }
}
